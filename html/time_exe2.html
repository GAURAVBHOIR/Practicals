<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
                                                                        
                                                                        
                                                     
  <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
  <title>1st ASTROSAT Workshop - Pulsar Astrophysics</title>
<SCRIPT type=text/javascript language="JavaScript" src="../scripts/nav.js"></script>
<SCRIPT type=text/javascript LANGUAGE="JavaScript" SRC="../scripts/overlib_sff.js"></SCRIPT>
<SCRIPT type=text/javascript LANGUAGE="JavaScript" SRC="../scripts/dtooltips_lib.js"></SCRIPT>
                                     
  <script type="text/javascript">
  function display_img(object, source) {
        if(document.getElementById){
                document.getElementById(object).src = source;
        }
        else if(document.all){
		document.all[object].style.src = source;
        }
        return;
	}
  </script>
</head>
  <body text="#000000" bgcolor="#ffffff" link="#2e34f2" vlink="#2e34f2" alink="#2e34f2">
<table cellpadding="0" cellspacing="0" border="0" width="1000" bgcolor="#1e1e1e">
  <tbody>
    <tr>
      <td valign="Top">
      <table cellpadding="2" cellspacing="2" border="0" width="100%">
        <tbody>
          <tr>
            <td valign="Center">
            <div align="Center"><img src="../images/neutron_small.gif" alt="Pulsar image" width="120" height="90">
            </div>
            </td>
            <td valign="Center" width="400">
            <div align="Center"><img src="../images/title_figure.gif" alt="Title fig" width="400" height="90">
            <br>
            </div>
            </td>
            <td valign="Center">
            <div align="Center"><img src="../images/astrosat_small.gif" alt="Astrosat image" width="140" height="90">
            <br>
            </div>
            </td>
          </tr>
        </tbody>
      </table>
      </td>
    </tr>
  </tbody>
</table>
<table cellpadding="0" cellspacing="0" border="0" width="1000">
  <tbody>
    <tr>
      <td valign="Top" bgcolor="#ffffff">
      <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tbody>
          <tr>
	  <td valign="Top" width="130" bgcolor="#2e34f2">
	    <img src="../images/sb_blank.gif" alt="side blank" width="125" height="15">
	    <a href="../html/sources.html" onmouseover="display_img('i_sources', '../images/sp_sources.gif'); return true;" onmouseout="display_img('i_sources', '../images/sw_sources.gif'); return true;"><img id="i_sources" src="../images/sw_sources.gif" alt="Side pulsar" width="125" height="30"></a>
	    <img id="b_timing" src="../images/sr_timing.gif" alt="Side timing" width="125" height="30">
	    <a href="../html/time_exe1.html" onmouseover="display_img('i_texe1', '../images/sp_exe1.gif'); return true;" onmouseout="display_img('i_texe1', '../images/sw_exe1.gif'); return true;"><img id="i_texe1" src="../images/sw_exe1.gif" alt="Exercise 1" width="125" height="30"></a>
	    <a href="../html/time_exe2.html" onmouseover="display_img('i_texe2', '../images/sp_exe2.gif'); return true;" onmouseout="display_img('i_texe2', '../images/sw_exe2.gif'); return true;"><img id="i_texe2" src="../images/sw_exe2.gif" alt="Exercise 2" width="125" height="30"></a>
	    <a href="../html/time_exe3.html" onmouseover="display_img('i_texe3', '../images/sp_exe3.gif'); return true;" onmouseout="display_img('i_texe3', '../images/sw_exe3.gif'); return true;"><img id="i_texe3" src="../images/sw_exe3.gif" alt="Exercise 3" width="125" height="30"></a>
	    <a href="../html/time_exe4.html" onmouseover="display_img('i_texe4', '../images/sp_exe4.gif'); return true;" onmouseout="display_img('i_texe4', '../images/sw_exe4.gif'); return true;"><img id="i_texe4" src="../images/sw_exe4.gif" alt="Exercise 4" width="125" height="30"></a>
	    <a href="../html/time_exe5.html" onmouseover="display_img('i_texe5', '../images/sp_exe5.gif'); return true;" onmouseout="display_img('i_texe5', '../images/sw_exe5.gif'); return true;"><img id="i_texe5" src="../images/sw_exe5.gif" alt="Exercise 5" width="125" height="30"></a>
	    <a href="../html/time_exe6.html" onmouseover="display_img('i_texe6', '../images/sp_exe6.gif'); return true;" onmouseout="display_img('i_texe6', '../images/sw_exe6.gif'); return true;"><img id="i_texe6" src="../images/sw_exe6.gif" alt="Exercise 6" width="125" height="30"></a>
	    <a href="../html/time_exe7.html" onmouseover="display_img('i_texe7', '../images/sp_exe7.gif'); return true;" onmouseout="display_img('i_texe7', '../images/sw_exe7.gif'); return true;"><img id="i_texe7" src="../images/sw_exe7.gif" alt="Exercise 7" width="125" height="30"></a>
	    <a href="../html/time_exe8.html" onmouseover="display_img('i_texe8', '../images/sp_exe8.gif'); return true;" onmouseout="display_img('i_texe8', '../images/sw_exe8.gif'); return true;"><img id="i_texe8" src="../images/sw_exe8.gif" alt="Exercise 8" width="125" height="30"></a>
	    <a href="../html/time_exe9.html" onmouseover="display_img('i_texe9', '../images/sp_exe9.gif'); return true;" onmouseout="display_img('i_texe9', '../images/sw_exe9.gif'); return true;"><img id="i_texe9" src="../images/sw_exe9.gif" alt="Exercise 9" width="125" height="30"></a>
	    <img id="b_timing" src="../images/sr_spectral.gif" alt="Side timing" width="125" height="30">
	    <a href="../html/spec_exe1.html" onmouseover="display_img('i_sexe1', '../images/sp_exe1.gif'); return true;" onmouseout="display_img('i_sexe1', '../images/sw_exe1.gif'); return true;"><img id="i_sexe1" src="../images/sw_exe1.gif" alt="Exercise 1" width="125" height="30"></a>
	    <a href="../html/spec_exe2.html" onmouseover="display_img('i_sexe2', '../images/sp_exe2.gif'); return true;" onmouseout="display_img('i_sexe2', '../images/sw_exe2.gif'); return true;"><img id="i_sexe2" src="../images/sw_exe2.gif" alt="Exercise 2" width="125" height="30"></a>
	    <a href="../html/spec_exe3.html" onmouseover="display_img('i_sexe3', '../images/sp_exe3.gif'); return true;" onmouseout="display_img('i_sexe3', '../images/sw_exe3.gif'); return true;"><img id="i_sexe3" src="../images/sw_exe3.gif" alt="Exercise 3" width="125" height="30"></a>
	    <a href="../html/spec_exe4.html" onmouseover="display_img('i_sexe4', '../images/sp_exe4.gif'); return true;" onmouseout="display_img('i_sexe4', '../images/sw_exe4.gif'); return true;"><img id="i_sexe4" src="../images/sw_exe4.gif" alt="Exercise 4" width="125" height="30"></a>
            <img src="../images/sb_blank.gif" alt="blank" width="125" height="15">
	    <a href="../html/exercises.html" onmouseover="display_img('i_backe', '../images/sp_backe.gif'); return true;" onmouseout="display_img('i_backe', '../images/sw_backe.gif'); return true;"><img id="i_backe" src="../images/sw_backe.gif" alt="Exercises main page" width="125" height="30"></a>
	    <img src="../images/sb_blank.gif" alt="side blank" width="125" height="15">
	    <a href="../html/workshop.html" onmouseover="display_img('i_back', '../images/sp_back.gif'); return true;" onmouseout="display_img('i_back', '../images/sw_back.gif'); return true;"><img id="i_back" src="../images/sw_back.gif" alt="Side pulsar" width="125" height="30"></a>
            </td>
            <td bgcolor="#ffffff" width="870" valign="Top" align="Left">
            <table cellpadding="20" cellspacing="2" border="0" width="100%">
              <tbody>
                <tr>
		<td valign="Top">
		
<h4>Timing Analysis: Exercise 2</h4>
<h2>Finding period by Fourrier analysis</h2>
 In the previous exercise we saw the individual pulses in the light curve 
of <a href="../html/sources.html#cenx-3">Cen X-3</a>
  . In this exercise we shall&nbsp; generate a Power Density Spectrum (PDS) 
from this light curve in order to find out its pulse period. The XRONOS&nbsp; 
package has a task named <i><a href="../manuals/xronos_manual/node6.html#SECTION00690000000000000000" target="new">
 powspec</a>
</i> , which generates the Fourier spectrum or PDS of a light curve. You already
have the light curve file <a href="../data/cenx-3_pca.lc">cenx-3_pca.lc</a>
  in your directory. Invoke <i>powspec</i> by entering the command at the 
prompt and give answers to the queries as shown below.  
<pre>pulsar&gt; <b>powspec<br><br></b>powspec 1.0 (xronos5.18)<br><br>Ser. 1 filename +options (or @file of filenames +options)[file1] <b>cenx-3_pca.lc<br></b>&nbsp;Series 1 file&nbsp;&nbsp; 1:cenx-3.lc<br><br>&nbsp;Selected FITS extensions: 1 - RATE TABLE;<br><br>&nbsp;Source ............ CEN_X-3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Start Time (d) .... 10507 00:19:27.562<br>&nbsp;FITS Extension ....&nbsp; 1 - `RATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; `&nbsp;&nbsp; Stop Time (d) ..... 10507 00:21:32.562<br>&nbsp;No. of Rows .......&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Bin Time (s) ......&nbsp;&nbsp; 0.1250<br>&nbsp;Right Ascension ...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Internal time sys.. Literal<br>&nbsp;Declination .......&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Experiment ........<br><br>&nbsp;Corrections applied: Vignetting - Yes; Deadtime - Yes; Bkgd - Yes; Clock - Yes<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; values: 1.00000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.00000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.00000000<br><br>&nbsp;Selected Columns:&nbsp; 1- Time;&nbsp; 3- Y-axis;&nbsp; 4- Y-error;&nbsp; 5- Fractional exposure;<br><br>&nbsp;File contains binned data.<br><br>Name of the window file ('-' for default window)[-] <b>-<br></b>&nbsp;Expected Start ... 10507.01351345407&nbsp; (days)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0:19:27:562&nbsp; (h:m:s:ms)<br>&nbsp;Expected Stop .... 10507.01496021276&nbsp; (days)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0:21:32:562&nbsp; (h:m:s:ms)<br><br>&nbsp;**** Warning: Newbin Time must be an integer multiple of Minimum Newbin Time<br>&nbsp;Minimum Newbin Time&nbsp;&nbsp; 0.12500000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (s)<br>&nbsp;for Maximum Newbin No..&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 60000<br><br>&nbsp;Default Newbin Time is:&nbsp; 1.0000000&nbsp;&nbsp;&nbsp; (s) (to have 1 Intv. of&nbsp;&nbsp;&nbsp; 8192 Newbins)<br>&nbsp;Type INDEF to accept the default value<br><br>Newbin Time or negative rebinning[4.6692607009327] <b>0.125</b></pre>
  All the queries so far are similar to those of lcurve! You give the name
 of the light curve file, window&nbsp; file (which is default in our case)
 and new bin time. Notice the warning saying that "Newbin Time must be an
integer multiple of Minimum Newbin Time". This is a requirement of powspec.
 
<pre>&nbsp;Newbin Time ......&nbsp;&nbsp;&nbsp; 0.12500000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (s)<br>&nbsp;Maximum Newbin No.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 60000<br><br>&nbsp;Default Newbins per Interval are:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8192<br>&nbsp;(giving&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8 Intervals of&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8192 Newbins)<br>&nbsp;Type INDEF to accept the default value<br><br>Number of Newbins/Interval[10] <b>8192<br></b>&nbsp;Maximum of&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8 Intvs. with&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8192 Newbins of&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.125000&nbsp;&nbsp;&nbsp;&nbsp; (s)</pre>
  There is one more requirement of powspec, that total number of newbins
per interval should be an integer&nbsp; power of 2. Here we shall accept
the default 8192 newbins per interval. This will give total 8 intervals i.e. 
the analysis will be carried out on 8 independent segments of the light curve 
each of 8192 bins. However, since total number of newbins are not multiple 
of 8192, the last segment will be half empty and we shall use only first 7
full segments.  
<pre>Default intervals per frame are:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1<br>Type INDEF to accept the default value<br>Number of Intervals/Frame[1] <b>7<br></b>&nbsp;Results from up to&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 7 Intvs. will be averaged in a Frame</pre>
  A frame is made by averaging results of the analysis of one or more contiguous
 intervals. Here we average 7 intervals in one frame and discard the last
interval. such averaging helps particularly in improving the statistics.
 
<pre>Rebin results? (&gt;1 const rebin, &lt;-1 geom. rebin, 0 none)[0] <b>0</b></pre>
  Right now we are not rebining our result. However, later you can experiment
 here by giving 1.01, 1.03, 1.05 and similar negative values as rebinning
factor and see the effect.  
<pre>Name of output file[default] <b>test<br></b>Do you want to plot your results?[yes] <b>yes<br></b>Enter PGPLOT device[/XW] <b>/xw<br><br></b>&nbsp;&nbsp;&nbsp; 4096 analysis results per interval<br><br>&nbsp;13% completed<br>&nbsp;Intv&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp; Start 10507&nbsp; 0:19:27<br>&nbsp;Ser.1&nbsp;&nbsp;&nbsp;&nbsp; Avg&nbsp; 1006.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Chisq 0.3487E+06&nbsp;&nbsp; Var 0.3427E+06 Newbs.&nbsp;&nbsp; 8192<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Min&nbsp; 248.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Max&nbsp; 3704.&nbsp;&nbsp;&nbsp; expVar&nbsp; 8050.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Bins&nbsp;&nbsp; 8192&nbsp;<br>Power spectrum ready !<br>&nbsp;Intv&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp; Start 10507&nbsp; 0:36:31<br>&nbsp;Ser.1&nbsp;&nbsp;&nbsp;&nbsp; Avg&nbsp; 1892.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Chisq 0.8259E+06&nbsp;&nbsp; Var 0.1526E+07 Newbs.&nbsp;&nbsp; 8192<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Min&nbsp; 416.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Max&nbsp; 8544.&nbsp;&nbsp;&nbsp; expVar 0.1514E+05&nbsp; Bins&nbsp;&nbsp; 8192&nbsp;<br>Power spectrum ready !<br>&nbsp;Intv&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp; Start 10507&nbsp; 0:53:35<br>&nbsp;Ser.1&nbsp;&nbsp;&nbsp;&nbsp; Avg&nbsp; 2701.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Chisq 0.1234E+07&nbsp;&nbsp; Var 0.3254E+07 Newbs.&nbsp;&nbsp; 8192<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Min&nbsp; 544.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Max 0.1116E+05expVar 0.2160E+05&nbsp; Bins&nbsp;&nbsp; 8192<br>Power spectrum ready !&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;Intv&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp; Start 10507&nbsp; 1:10:39<br>&nbsp;Ser.1&nbsp;&nbsp;&nbsp;&nbsp; Avg&nbsp; 3868.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Chisq 0.1730E+07&nbsp;&nbsp; Var 0.6535E+07 Newbs.&nbsp;&nbsp; 8192<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Min&nbsp; 672.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Max 0.1471E+05expVar 0.3094E+05&nbsp; Bins&nbsp;&nbsp; 8192<br>Power spectrum ready !<br>&nbsp;Intv&nbsp;&nbsp;&nbsp; 5&nbsp;&nbsp; Start 10507&nbsp; 1:27:43<br>&nbsp;Ser.1&nbsp;&nbsp;&nbsp;&nbsp; Avg&nbsp; 4722.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Chisq 0.1111E+07&nbsp;&nbsp; Var 0.8197E+07 Newbs.&nbsp;&nbsp; 5120<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Min&nbsp; 1176.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Max 0.1633E+05expVar 0.3778E+05&nbsp; Bins&nbsp;&nbsp; 5120<br>Power spectrum ready !<br>&nbsp;Intv&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp; Start 10507&nbsp; 1:54:23<br>&nbsp;Ser.1&nbsp;&nbsp;&nbsp;&nbsp; Avg&nbsp; 4806.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Chisq 0.2097E+07&nbsp;&nbsp; Var 0.9842E+07 Newbs.&nbsp;&nbsp; 8192<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Min&nbsp; 944.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Max 0.1780E+05expVar 0.3845E+05&nbsp; Bins&nbsp;&nbsp; 8192<br>Power spectrum ready !<br>&nbsp;Intv&nbsp;&nbsp;&nbsp; 7&nbsp;&nbsp; Start 10507&nbsp; 2:11:27<br>&nbsp;Ser.1&nbsp;&nbsp;&nbsp;&nbsp; Avg&nbsp; 4696.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Chisq 0.1486E+07&nbsp;&nbsp; Var 0.8946E+07 Newbs.&nbsp;&nbsp; 6240<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Min&nbsp; 928.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Max 0.2020E+05expVar 0.3757E+05&nbsp; Bins&nbsp;&nbsp; 6240<br>Power spectrum ready !<br>PLT&gt;</pre>
  Now you should see a Power Density Spectrum with two clear peaks. The prominent
 peak corresponds to the pulse period whereas the second peak corresponds
to the first harmonic of the period.  
<p>You can resize and plot the X axis logarithmically by executing a PLT
command. This will help to find out the exact position of the peak corresponding
to pulse period. </p>
<pre>PLT&gt; r x 0.05 5<br>PLT&gt; log x on<br>PLT&gt; plot</pre>
  You should see a plot as shown below.  
<p><img align="Center" src="../images/cenx-3_pds.gif" alt="Power Density Spectrum for Cen X-3">
</p>
<p>You can also find out the exact frequency of the peak by fitting a function
 like gaussian to the peak. Consult the QDP/PLT User's Guide or one of the
 instructors to find out how to do this. </p>
<br>
                  </td>
                </tr>
              </tbody>
            </table>
            </td>
          </tr>
        </tbody>
      </table>
      </td>
    </tr>
  </tbody>
</table>
<br>
<br>
<hr width="80%" size="1"><br>
<p>
This workshop is being organized by <a href="http://www.tifr.res.in/school_nsciences/daa/index.html" 
target="new">Department of Astronomy &amp; Astrophysics</a>, <a href="http://www.tifr.res.in" 
target="new">Tata Institute of Fundamental Research&nbsp;(TIFR)</a> and is sponsored by 
<a href="http://www.isro.org">Indian Space Research Organization &nbsp;(ISRO)</a>.<br>
</p>
</body>
</html>
